<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>익명 메시지 보내기</title>
</head>
<body>
  <h2>익명 메시지</h2>
  <textarea id="msg" placeholder="메시지를 입력하세요"></textarea><br>
  <button id="sendBtn">보내기</button>
  <p id="status"></p>

  <script type="module">
    import { db } from "./firebase.js";
    import { addDoc, collection, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const params = new URLSearchParams(location.search);
    const toUid = params.get("u");

    sendBtn.onclick = async () => {
      await addDoc(collection(db, "messages"), {
        toUid,
        content: msg.value,
        createdAt: serverTimestamp(),
        isRead: false
      });
      status.innerText = "✅ 전송 완료!";
      msg.value = "";
    };
  </script>
</body>
</html>
